# EV Charging Simulation - Multi-Network Lab Configuration
# =========================================================
# Bu yapılandırma "different networks" gereksinimini karşılar
# Gerçek dünya senaryosunu simüle eder:
#
# NETWORK TOPOLOGY (4 Isolated Networks):
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │                         INFRASTRUCTURE NETWORK                               │
# │                         (backend-network: 172.30.0.0/24)                    │
# │  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐                   │
# │  │    Kafka     │    │  EV-Central  │    │  EV-Registry │                   │
# │  │ 172.30.0.10  │    │ 172.30.0.20  │    │ 172.30.0.30  │                   │
# │  └──────────────┘    └──────────────┘    └──────────────┘                   │
# └─────────────────────────────────────────────────────────────────────────────┘
#                              │ (Gateway/Bridge)
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │                    CHARGING STATION NETWORK (Field Devices)                 │
# │                    (charging-network: 172.31.0.0/24)                        │
# │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐               │
# │  │ CP-001  │ │ CP-002  │ │ CP-003  │ │ CP-004  │ │ CP-005  │  ...          │
# │  │ Engine  │ │ Engine  │ │ Engine  │ │ Engine  │ │ Engine  │               │
# │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘               │
# └─────────────────────────────────────────────────────────────────────────────┘
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │                      MONITORING NETWORK (Operations)                         │
# │                      (monitoring-network: 172.32.0.0/24)                     │
# │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐               │
# │  │ CP-001  │ │ CP-002  │ │ CP-003  │ │ CP-004  │ │ CP-005  │  ...          │
# │  │ Monitor │ │ Monitor │ │ Monitor │ │ Monitor │ │ Monitor │               │
# │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘               │
# └─────────────────────────────────────────────────────────────────────────────┘
#
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │                        CUSTOMER NETWORK (End Users)                          │
# │                        (customer-network: 172.33.0.0/24)                     │
# │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐               │
# │  │  Alice  │ │   Bob   │ │ Charlie │ │  David  │ │   Eve   │               │
# │  │ Driver  │ │ Driver  │ │ Driver  │ │ Driver  │ │ Driver  │               │
# │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘               │
# └─────────────────────────────────────────────────────────────────────────────┘
#
# SECURITY ISOLATION:
# - Charging Points CAN'T directly access Customer Network
# - Drivers CAN'T directly access Backend Infrastructure  
# - All communication goes through Kafka (message broker)
# - EV-Central acts as gateway between networks
#
# LAB DEMONSTRATION:
# - Show network isolation with: docker network inspect <network-name>
# - Show cross-network communication via Kafka
# - Demonstrate that CP can't ping Driver directly

services:
  # ========== INFRASTRUCTURE NETWORK (Backend) ==========
  
  kafka:
    image: apache/kafka:3.7.0
    container_name: ev-kafka
    hostname: kafka
    ports:
      - "9092:9092"
    environment:
      KAFKA_NODE_ID: 1
      KAFKA_PROCESS_ROLES: broker,controller
      KAFKA_LISTENERS: PLAINTEXT://0.0.0.0:9092,CONTROLLER://0.0.0.0:9093
      # Use kafka hostname - accessible from all networks
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092
      KAFKA_CONTROLLER_LISTENER_NAMES: CONTROLLER
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT
      KAFKA_CONTROLLER_QUORUM_VOTERS: 1@localhost:9093
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1
      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0
      KAFKA_NUM_PARTITIONS: 3
      CLUSTER_ID: 'MkU3OEVBNTcwNTJENDM2Qk'
    volumes:
      - kafka-data:/var/lib/kafka/data
    healthcheck:
      test: ["CMD-SHELL", "nc -z localhost 9092 || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 10
      start_period: 40s
    networks:
      backend-network:
        ipv4_address: 172.30.0.10
      # Kafka needs to be accessible from all networks (message broker)
      charging-network:
        ipv4_address: 172.31.0.10
      monitoring-network:
        ipv4_address: 172.32.0.10
      customer-network:
        ipv4_address: 172.33.0.10
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  # Central Controller - Gateway between all networks
  ev-central:
    build:
      context: .
      dockerfile: docker/Dockerfile.central
    container_name: ev-central
    ports:
      - "8000:8000"  # HTTP Dashboard
      - "9999:9999"  # TCP Control
    environment:
      SERVICE_TYPE: central
      CENTRAL_KAFKA_BOOTSTRAP: kafka:9092
      CENTRAL_HTTP_PORT: 8000
      CENTRAL_LISTEN_PORT: 9999
      CENTRAL_LOG_LEVEL: INFO
      EV_SECURITY_SECRET: ${EV_SECURITY_SECRET}
      EV_KEY_ENCRYPTION_SECRET: ${EV_KEY_ENCRYPTION_SECRET:-lab-env-key-encryption-secret-min32chars}
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      # Per-CP encryption keys (must match CP Engine keys for encrypted communication)
      EV_CP_001_ENCRYPTION_KEY: ${EV_CP_001_ENCRYPTION_KEY:-}
      EV_CP_002_ENCRYPTION_KEY: ${EV_CP_002_ENCRYPTION_KEY:-}
      EV_CP_003_ENCRYPTION_KEY: ${EV_CP_003_ENCRYPTION_KEY:-}
      EV_CP_004_ENCRYPTION_KEY: ${EV_CP_004_ENCRYPTION_KEY:-}
      EV_CP_005_ENCRYPTION_KEY: ${EV_CP_005_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_healthy
    networks:
      backend-network:
        ipv4_address: 172.30.0.20
      # Central is the gateway - needs access to customer network for HTTP API
      customer-network:
        ipv4_address: 172.33.0.20
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "python -c 'import urllib.request; urllib.request.urlopen(\"http://localhost:8000/health\")'"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 15s

  ev-registry:
    build:
      context: .
      dockerfile: docker/Dockerfile.registry
    container_name: ev-registry
    ports:
      - "8080:8080"
    environment:
      REGISTRY_API_PORT: 8080
      REGISTRY_DB_PATH: /data/ev_registry.db
      REGISTRY_LOG_LEVEL: INFO
      REGISTRY_TOKEN_EXPIRATION_HOURS: 24
      REGISTRY_SECRET_KEY: ${REGISTRY_SECRET_KEY}
      REGISTRY_JWT_ISSUER: "ev-registry"
      REGISTRY_JWT_AUDIENCE: "ev-central"
      REGISTRY_TLS_ENABLED: "${REGISTRY_TLS_ENABLED:-false}"
      REGISTRY_ALLOW_INSECURE: "${REGISTRY_ALLOW_INSECURE:-true}"
      REGISTRY_REQUIRE_CERTIFICATE: "${REGISTRY_REQUIRE_CERTIFICATE:-false}"
      REGISTRY_ADMIN_API_KEY: "${REGISTRY_ADMIN_API_KEY:-}"
    volumes:
      - registry-data:/data
    networks:
      backend-network:
        ipv4_address: 172.30.0.30
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 10s

  ev-weather:
    build:
      context: .
      dockerfile: docker/Dockerfile.weather
    container_name: ev-weather
    ports:
      - "8003:8003"
    environment:
      OPENWEATHER_API_KEY: ${OPENWEATHER_API_KEY}
      WEATHER_CENTRAL_HTTP_URL: http://172.30.0.20:8000
      WEATHER_POLL_INTERVAL: ${WEATHER_POLLING_INTERVAL:-4}
      WEATHER_CITY_FILE: ${CITY_FILE:-/app/evcharging/common/CP_cities.txt}
      WEATHER_LOG_LEVEL: ${LOG_LEVEL:-INFO}
    depends_on:
      ev-central:
        condition: service_healthy
    networks:
      backend-network:
        ipv4_address: 172.30.0.40
    restart: unless-stopped

  # ========== CHARGING NETWORK (Field Devices - Isolated) ==========
  # CP Engines are in their own isolated network
  # They can ONLY communicate via Kafka - cannot reach customers directly
  
  ev-cp-e-1:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_e
    container_name: ev-cp-e-1
    environment:
      CP_ENGINE_KAFKA_BOOTSTRAP: kafka:9092
      CP_ENGINE_CP_ID: CP-001
      CP_ENGINE_HEALTH_PORT: 8001
      CP_ENGINE_LOG_LEVEL: INFO
      CP_ENGINE_KW_RATE: 22.0
      CP_ENGINE_EURO_RATE: 0.30
      CP_ENGINE_TELEMETRY_INTERVAL: 1.0
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      EV_CP_ENCRYPTION_KEY: ${EV_CP_001_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_started
    networks:
      charging-network:
        ipv4_address: 172.31.0.101
    restart: unless-stopped

  ev-cp-e-2:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_e
    container_name: ev-cp-e-2
    environment:
      CP_ENGINE_KAFKA_BOOTSTRAP: kafka:9092
      CP_ENGINE_CP_ID: CP-002
      CP_ENGINE_HEALTH_PORT: 8002
      CP_ENGINE_LOG_LEVEL: INFO
      CP_ENGINE_KW_RATE: 50.0
      CP_ENGINE_EURO_RATE: 0.35
      CP_ENGINE_TELEMETRY_INTERVAL: 1.0
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      EV_CP_ENCRYPTION_KEY: ${EV_CP_002_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_started
    networks:
      charging-network:
        ipv4_address: 172.31.0.102
    restart: unless-stopped

  ev-cp-e-3:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_e
    container_name: ev-cp-e-3
    environment:
      CP_ENGINE_KAFKA_BOOTSTRAP: kafka:9092
      CP_ENGINE_CP_ID: CP-003
      CP_ENGINE_HEALTH_PORT: 8003
      CP_ENGINE_LOG_LEVEL: INFO
      CP_ENGINE_KW_RATE: 43.0
      CP_ENGINE_EURO_RATE: 0.32
      CP_ENGINE_TELEMETRY_INTERVAL: 1.0
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      EV_CP_ENCRYPTION_KEY: ${EV_CP_003_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_started
    networks:
      charging-network:
        ipv4_address: 172.31.0.103
    restart: unless-stopped

  ev-cp-e-4:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_e
    container_name: ev-cp-e-4
    environment:
      CP_ENGINE_KAFKA_BOOTSTRAP: kafka:9092
      CP_ENGINE_CP_ID: CP-004
      CP_ENGINE_HEALTH_PORT: 8004
      CP_ENGINE_LOG_LEVEL: INFO
      CP_ENGINE_KW_RATE: 150.0
      CP_ENGINE_EURO_RATE: 0.40
      CP_ENGINE_TELEMETRY_INTERVAL: 1.0
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      EV_CP_ENCRYPTION_KEY: ${EV_CP_004_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_started
    networks:
      charging-network:
        ipv4_address: 172.31.0.104
    restart: unless-stopped

  ev-cp-e-5:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_e
    container_name: ev-cp-e-5
    environment:
      CP_ENGINE_KAFKA_BOOTSTRAP: kafka:9092
      CP_ENGINE_CP_ID: CP-005
      CP_ENGINE_HEALTH_PORT: 8005
      CP_ENGINE_LOG_LEVEL: INFO
      CP_ENGINE_KW_RATE: 7.2
      CP_ENGINE_EURO_RATE: 0.28
      CP_ENGINE_TELEMETRY_INTERVAL: 1.0
      EV_KAFKA_ENCRYPTION: ${EV_KAFKA_ENCRYPTION:-false}
      EV_CP_ENCRYPTION_KEY: ${EV_CP_005_ENCRYPTION_KEY:-}
    depends_on:
      kafka:
        condition: service_started
    networks:
      charging-network:
        ipv4_address: 172.31.0.105
    restart: unless-stopped

  # ========== MONITORING NETWORK (Operations - Isolated) ==========
  # Monitors can see CP health but are in separate network
  
  ev-cp-m-1:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_m
    container_name: ev-cp-m-1
    environment:
      CP_MONITOR_CP_ID: CP-001
      CP_MONITOR_KAFKA_BOOTSTRAP: kafka:9092
      CP_MONITOR_CP_E_HOST: 172.31.0.101
      CP_MONITOR_CP_E_PORT: 8001
      CP_MONITOR_CENTRAL_HOST: ev-central
      CP_MONITOR_CENTRAL_PORT: 8000
      CP_MONITOR_HEALTH_INTERVAL: 5.0
      CP_MONITOR_LOG_LEVEL: INFO
    depends_on:
      kafka:
        condition: service_started
      ev-cp-e-1:
        condition: service_started
    networks:
      monitoring-network:
        ipv4_address: 172.32.0.101
      # Need charging network access to reach CP health endpoints
      charging-network:
        ipv4_address: 172.31.0.201
      # Need backend network to reach Central HTTP API
      backend-network:
        ipv4_address: 172.30.0.121
    restart: unless-stopped

  ev-cp-m-2:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_m
    container_name: ev-cp-m-2
    environment:
      CP_MONITOR_CP_ID: CP-002
      CP_MONITOR_KAFKA_BOOTSTRAP: kafka:9092
      CP_MONITOR_CP_E_HOST: 172.31.0.102
      CP_MONITOR_CP_E_PORT: 8002
      CP_MONITOR_CENTRAL_HOST: ev-central
      CP_MONITOR_CENTRAL_PORT: 8000
      CP_MONITOR_HEALTH_INTERVAL: 5.0
      CP_MONITOR_LOG_LEVEL: INFO
    depends_on:
      kafka:
        condition: service_started
      ev-cp-e-2:
        condition: service_started
    networks:
      monitoring-network:
        ipv4_address: 172.32.0.102
      charging-network:
        ipv4_address: 172.31.0.202
      backend-network:
        ipv4_address: 172.30.0.122
    restart: unless-stopped

  ev-cp-m-3:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_m
    container_name: ev-cp-m-3
    environment:
      CP_MONITOR_CP_ID: CP-003
      CP_MONITOR_KAFKA_BOOTSTRAP: kafka:9092
      CP_MONITOR_CP_E_HOST: 172.31.0.103
      CP_MONITOR_CP_E_PORT: 8003
      CP_MONITOR_CENTRAL_HOST: ev-central
      CP_MONITOR_CENTRAL_PORT: 8000
      CP_MONITOR_HEALTH_INTERVAL: 5.0
      CP_MONITOR_LOG_LEVEL: INFO
    depends_on:
      kafka:
        condition: service_started
      ev-cp-e-3:
        condition: service_started
    networks:
      monitoring-network:
        ipv4_address: 172.32.0.103
      charging-network:
        ipv4_address: 172.31.0.203
      backend-network:
        ipv4_address: 172.30.0.123
    restart: unless-stopped

  ev-cp-m-4:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_m
    container_name: ev-cp-m-4
    environment:
      CP_MONITOR_CP_ID: CP-004
      CP_MONITOR_KAFKA_BOOTSTRAP: kafka:9092
      CP_MONITOR_CP_E_HOST: 172.31.0.104
      CP_MONITOR_CP_E_PORT: 8004
      CP_MONITOR_CENTRAL_HOST: ev-central
      CP_MONITOR_CENTRAL_PORT: 8000
      CP_MONITOR_HEALTH_INTERVAL: 5.0
      CP_MONITOR_LOG_LEVEL: INFO
    depends_on:
      kafka:
        condition: service_started
      ev-cp-e-4:
        condition: service_started
    networks:
      monitoring-network:
        ipv4_address: 172.32.0.104
      charging-network:
        ipv4_address: 172.31.0.204
      backend-network:
        ipv4_address: 172.30.0.124
    restart: unless-stopped

  ev-cp-m-5:
    build:
      context: .
      dockerfile: docker/Dockerfile.cp_m
    container_name: ev-cp-m-5
    environment:
      CP_MONITOR_CP_ID: CP-005
      CP_MONITOR_KAFKA_BOOTSTRAP: kafka:9092
      CP_MONITOR_CP_E_HOST: 172.31.0.105
      CP_MONITOR_CP_E_PORT: 8005
      CP_MONITOR_CENTRAL_HOST: ev-central
      CP_MONITOR_CENTRAL_PORT: 8000
      CP_MONITOR_HEALTH_INTERVAL: 5.0
      CP_MONITOR_LOG_LEVEL: INFO
    depends_on:
      kafka:
        condition: service_started
      ev-cp-e-5:
        condition: service_started
    networks:
      monitoring-network:
        ipv4_address: 172.32.0.105
      charging-network:
        ipv4_address: 172.31.0.205
      backend-network:
        ipv4_address: 172.30.0.125
    restart: unless-stopped

  # ========== CUSTOMER NETWORK (End Users - Isolated) ==========
  # Drivers are in their own network - can only reach Central's HTTP API
  # Cannot directly communicate with Charging Points
  
  ev-driver-alice:
    build:
      context: .
      dockerfile: docker/Dockerfile.driver
    container_name: ev-driver-alice
    environment:
      DRIVER_DRIVER_ID: driver-alice
      DRIVER_KAFKA_BOOTSTRAP: kafka:9092
      DRIVER_REQUEST_INTERVAL: 8.0
      DRIVER_LOG_LEVEL: INFO
      DRIVER_DASHBOARD_PORT: 8100
      DRIVER_CENTRAL_HTTP_URL: http://172.33.0.20:8000
      DRIVER_AUTO_RUN_REQUESTS: "false"
    volumes:
      - ./requests.txt:/app/requests.txt:ro
    ports:
      - "8100:8100"
    depends_on:
      kafka:
        condition: service_started
      ev-central:
        condition: service_started
    networks:
      customer-network:
        ipv4_address: 172.33.0.101
    restart: unless-stopped

  ev-driver-bob:
    build:
      context: .
      dockerfile: docker/Dockerfile.driver
    container_name: ev-driver-bob
    environment:
      DRIVER_DRIVER_ID: driver-bob
      DRIVER_KAFKA_BOOTSTRAP: kafka:9092
      DRIVER_REQUEST_INTERVAL: 12.0
      DRIVER_LOG_LEVEL: INFO
      DRIVER_DASHBOARD_PORT: 8101
      DRIVER_CENTRAL_HTTP_URL: http://172.33.0.20:8000
      DRIVER_AUTO_RUN_REQUESTS: "false"
    volumes:
      - ./requests.txt:/app/requests.txt:ro
    ports:
      - "8101:8101"
    depends_on:
      kafka:
        condition: service_started
      ev-central:
        condition: service_started
    networks:
      customer-network:
        ipv4_address: 172.33.0.102
    restart: unless-stopped

  ev-driver-charlie:
    build:
      context: .
      dockerfile: docker/Dockerfile.driver
    container_name: ev-driver-charlie
    environment:
      DRIVER_DRIVER_ID: driver-charlie
      DRIVER_KAFKA_BOOTSTRAP: kafka:9092
      DRIVER_REQUEST_INTERVAL: 20.0
      DRIVER_LOG_LEVEL: INFO
      DRIVER_DASHBOARD_PORT: 8102
      DRIVER_CENTRAL_HTTP_URL: http://172.33.0.20:8000
      DRIVER_AUTO_RUN_REQUESTS: "false"
    volumes:
      - ./requests.txt:/app/requests.txt:ro
    ports:
      - "8102:8102"
    depends_on:
      kafka:
        condition: service_started
      ev-central:
        condition: service_started
    networks:
      customer-network:
        ipv4_address: 172.33.0.103
    restart: unless-stopped

  ev-driver-david:
    build:
      context: .
      dockerfile: docker/Dockerfile.driver
    container_name: ev-driver-david
    environment:
      DRIVER_DRIVER_ID: driver-david
      DRIVER_KAFKA_BOOTSTRAP: kafka:9092
      DRIVER_REQUEST_INTERVAL: 15.0
      DRIVER_LOG_LEVEL: INFO
      DRIVER_DASHBOARD_PORT: 8103
      DRIVER_CENTRAL_HTTP_URL: http://172.33.0.20:8000
      DRIVER_AUTO_RUN_REQUESTS: "false"
    volumes:
      - ./requests.txt:/app/requests.txt:ro
    ports:
      - "8103:8103"
    depends_on:
      kafka:
        condition: service_started
      ev-central:
        condition: service_started
    networks:
      customer-network:
        ipv4_address: 172.33.0.104
    restart: unless-stopped

  ev-driver-eve:
    build:
      context: .
      dockerfile: docker/Dockerfile.driver
    container_name: ev-driver-eve
    environment:
      DRIVER_DRIVER_ID: driver-eve
      DRIVER_KAFKA_BOOTSTRAP: kafka:9092
      DRIVER_REQUEST_INTERVAL: 10.0
      DRIVER_LOG_LEVEL: INFO
      DRIVER_DASHBOARD_PORT: 8104
      DRIVER_CENTRAL_HTTP_URL: http://172.33.0.20:8000
      DRIVER_AUTO_RUN_REQUESTS: "false"
    volumes:
      - ./requests.txt:/app/requests.txt:ro
    ports:
      - "8104:8104"
    depends_on:
      kafka:
        condition: service_started
      ev-central:
        condition: service_started
    networks:
      customer-network:
        ipv4_address: 172.33.0.105
    restart: unless-stopped

# ========== NETWORK DEFINITIONS ==========
# 4 Isolated Networks with specific subnets

networks:
  # Backend Infrastructure Network (Kafka, Central, Registry)
  backend-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.30.0.0/24
          gateway: 172.30.0.1
    labels:
      description: "Backend infrastructure - Kafka, Central Controller, Registry"
      isolation: "high"

  # Charging Station Network (CP Engines)
  charging-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.31.0.0/24
          gateway: 172.31.0.1
    labels:
      description: "Field devices - Charging Point Engines"
      isolation: "medium"

  # Monitoring/Operations Network (CP Monitors)
  monitoring-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.32.0.0/24
          gateway: 172.32.0.1
    labels:
      description: "Operations - Health Monitors"
      isolation: "medium"

  # Customer/End-User Network (Drivers)
  customer-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.33.0.0/24
          gateway: 172.33.0.1
    labels:
      description: "End users - EV Drivers"
      isolation: "low"

volumes:
  kafka-data:
  registry-data:
